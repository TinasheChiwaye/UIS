@model Funeral.Model.FuneralServiceViewModel
@{
    ViewBag.Title = "Funeral Service";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<head>
    <title>@ViewBag.Title</title>
</head> 
<body>
    <div class="ibox ">
        <div class="ibox-title">
            <h5>Invoice</h5>
        </div>
        <div class="ibox-content">
            <div class="row">
                <div class="col-lg-6">
                    <div class="form-group">
                        <div class="form-group">
                            <label>Bill From</label>
                            @{
                                string billFrom = Model.ApplicationSettingsModel.ApplicationName + Environment.NewLine + Model.ApplicationSettingsModel.BusinessAddressLine1 + "," + Environment.NewLine + Model.ApplicationSettingsModel.BusinessAddressLine2 + "," + Environment.NewLine + Model.ApplicationSettingsModel.BusinessAddressLine3 + "," + Environment.NewLine + Model.ApplicationSettingsModel.BusinessAddressLine4 + Environment.NewLine + Model.ApplicationSettingsModel.BusinessPostalCode;
                            }
                            @Html.TextArea("BillFrom", billFrom, new { @class = "form-control", @multiline = "multiline", @rows = "6", @ReadOnly = "true" })
                        </div>
                        <div class="form-group">
                            <label>Bill to </label>
                            @{
                                string billTo = Model.FuneralModel.Surname + " " + Model.FuneralModel.FullNames + Environment.NewLine + Model.FuneralModel.Address1 + "," + Environment.NewLine + Model.FuneralModel.Address2 + "," + Environment.NewLine + Model.FuneralModel.Address3 + "," + Environment.NewLine + Model.FuneralModel.Address4 + Environment.NewLine + Model.FuneralModel.Code;
                            }
                            @Html.TextArea("BillTo", billTo, new { @class = "form-control", @multiline = "multiline", @rows = "6", @ReadOnly = "true" })
                        </div>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="form-group">
                        <div class="col-lg-12">
                            <div class="col-lg-6">
                                <div class="form-group">
                                </div>

                            </div>
                            <div class="col-lg-6">
                                <div class="form-group">
                                    <div class="form-group">
                                        <label>Invoice Number</label>
                                        @Html.TextBoxFor(x => x.FuneralModel.InvoiceNumber, new { @class = "form-control", @ReadOnly = "true" })
                                    </div>
                                    <div class="form-group">
                                        <label>Date</label>
                                        @{
                                            string date = string.Empty;
                                            string CreatedDate = Model.FuneralModel.CreatedDate.ToString();
                                            if (CreatedDate == null || CreatedDate == "01-01-0001 00:00:00")
                                            {
                                                date = System.DateTime.Now.ToString("dd/MMM/yyyy");
                                            }
                                            else
                                            {
                                                date = Model.FuneralModel.CreatedDate.ToString("dd/MMM/yyyy");
                                            }
                                        }
                                        @Html.TextBox("Date", date, new { @class = "form-control", @ReadOnly = "true" })
                                    </div>
                                    <div class="form-group">
                                        <label>Due Date</label>
                                        @{
                                            DateTime Start = DateTime.Parse(date);
                                            DateTime end = Start.AddHours(48);
                                            string dueDate = end.ToString("dd/MMM/yyyy");
                                        }
                                        @Html.TextBox("DueDate", dueDate, new { @class = "form-control", @ReadOnly = "true" })
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="ibox float-e-margins">
            <div class="ibox-title">
                <h5>Services</h5>
            </div>
            <div class="ibox-content">

                <asp:UpdatePanel ID="UpddlBranch" runat="server" UpdateMode="Conditional">
                    <ContentTemplate>
                        <div class="col-lg-6">
                            <div class="form-group">
                                <label>Package</label>
                                <asp:DropDownList runat="server" ID="ddlPackage" class="form-control m-b" AutoPostBack="true">
                                </asp:DropDownList>
                            </div>
                            <div class="form-group">
                                <label>Select Services</label>
                                <asp:DropDownList runat="server" ID="ddlServices" class="form-control m-b" AutoPostBack="true" OnSelectedIndexChanged="ChangeData">
                                </asp:DropDownList>
                                <asp:RequiredFieldValidator ID="RequiredFieldValidator3" runat="server" ControlToValidate="ddlServices" InitialValue="0" ErrorMessage="Please select something" ValidationGroup="vadd" />
                            </div>
                            <div class="form-group">
                                <label>Qty</label>
                                <asp:TextBox MaxLength="10" runat="server" ID="txtNumber" name="txtNumber" type="number" class="form-control" OnTextChanged="calculation" AutoPostBack="true"></asp:TextBox>
                                <asp:RequiredFieldValidator ID="RequiredFieldValidator2" runat="server" ErrorMessage="This Field Required" ControlToValidate="txtNumber" ValidationGroup="vadd"></asp:RequiredFieldValidator>
                            </div>

                        </div>
                        <div class="col-lg-6">
                            <div class="form-group">
                                <label>Desctiption</label>
                                <asp:TextBox MaxLength="10" runat="server" ID="txtSerDes" name="" type="text" class="form-control" ReadOnly="true"></asp:TextBox>
                            </div>
                            <div class="form-group">
                                <label>Rate</label>
                                <asp:TextBox MaxLength="10" runat="server" ID="txtRate" name="" type="text" class="form-control" AutoPostBack="true" OnTextChanged="calculation" onkeypress="return isDecimalNumber1(event,this);">0</asp:TextBox>

                                <asp:RequiredFieldValidator ID="RequiredFieldValidator1" runat="server" ErrorMessage="This Field Required" ControlToValidate="txtRate" ValidationGroup="vadd"></asp:RequiredFieldValidator>

                            </div>
                            <div class="form-group">
                                <label>Total</label>
                                <asp:TextBox MaxLength="10" runat="server" ID="txtTotal" name="" type="text" class="form-control" ReadOnly="true"></asp:TextBox>

                            </div>
                        </div>
                    </ContentTemplate>
                </asp:UpdatePanel>
                <div class="form-group">
                    <asp:Button ID="btnPackageService" CssClass="btn btn-sm btn-primary" runat="server" Text="Add Package" OnClick="btnPackageService_Click" />
                    <asp:Button ID="AddServ" CssClass="btn btn-sm btn-primary" runat="server" Text="Add Service" ValidationGroup="vadd" OnClick="btncrtService_Click" />
                </div>

                <%--start --%>
                <asp:GridView ID="gvServiceList" OnRowDataBound="gvServiceList_RowDataBound" runat="server" Width="100%" CssClass="table table-striped table-bordered table-hover" AutoGenerateColumns="False" EmptyDataText="There are no Service added." OnRowCommand="gvService_RowCommand">
                    <PagerStyle CssClass="pagination-ys" />
                    <Columns>
                        <asp:BoundField DataField="ServiceName" HeaderText="Service Name" ReadOnly="True" HeaderStyle-CssClass="visible-lg" ItemStyle-CssClass="visible-lg" />

                        <asp:BoundField DataField="ServiceDesc" HeaderText="Desctiption" ReadOnly="True" ItemStyle-CssClass="visible-lg" HeaderStyle-CssClass="visible-lg" />

                        <asp:BoundField DataField="ServiceRate" HeaderText="Rate" ReadOnly="True" HeaderStyle-CssClass="visible-lg" ItemStyle-CssClass="visible-lg" />
                        <asp:BoundField DataField="Quantity" HeaderText="QTY" ReadOnly="True" HeaderStyle-CssClass="visible-lg" ItemStyle-CssClass="visible-lg" />
                        <%--<asp:BoundField DataField="DateOfQuotation" HeaderText="QuoatationDate" ReadOnly="True" SortExpression="DateOfQuotation" DataFormatString="{0:d}" HeaderStyle-CssClass="visible-lg" ItemStyle-CssClass="visible-lg" />--%>

                        <asp:BoundField DataField="Amount" HeaderText="Amount" ReadOnly="True" HeaderStyle-CssClass="visible-lg" ItemStyle-CssClass="visible-lg" />
                        <asp:TemplateField HeaderText="Actions">
                            <ItemTemplate>
                                <%if (this.HasEditRight)
                                { %>
                                <asp:LinkButton runat="server" ID="lbtnEditDependant" ToolTip="Click here To Edit Service" CommandArgument='<%#Eval("pkiFuneralServiceSelectionID") %>' CommandName="EditService"><i class="fa fa-edit"></i></asp:LinkButton>
                                &nbsp;
                                <%}
                                if (this.HasDeleteRight)
                                {%>
                                <asp:LinkButton runat="server" ID="lbtnDeleteDependatn" ToolTip="Click here To Delete Service" OnClientClick="return confirm('Are you sure you want to delete it?')" CommandArgument='<%#Eval("pkiFuneralServiceSelectionID") %>' CommandName="DeleteService"><i class="fa fa-trash"></i></asp:LinkButton>
                                <%} %>
                            </ItemTemplate>
                        </asp:TemplateField>
                    </Columns>
                </asp:GridView>

                <%-- end --%>
            </div>
        </div>
</body>
